# API Key Manager 需求文档

## 1. 项目概述

### 1.1 项目背景
随着AIGC和vibe coding的快速发展，开发者需要管理多个AI平台的API Key。现有解决方案要么需要付费，要么界面丑陋，缺乏轻量简洁的个人管理工具。

### 1.2 项目目标
开发一款轻量、简洁、安全的个人API Key管理桌面软件，提供便捷的Key管理和快速调用功能。

### 1.3 核心价值主张
- **轻量高效**：快速启动，低资源占用
- **便捷易用**：简洁界面，直观操作
- **快速调用**：全局快捷键，无缝集成开发流程
- **安全可靠**：本地加密存储，保护敏感数据

## 2. 目标用户

### 2.1 主要用户群体
- AIGC开发者和研究者
- 使用多个AI平台的开发者
- 需要频繁切换和管理API Key的技术人员

### 2.2 用户痛点
- API Key分散存储，管理不便
- 现有工具界面丑陋或需要付费
- 缺乏快速调用和自动填充功能
- 安全性担忧（明文存储风险）

## 3. 功能需求

### 3.1 核心功能

#### 3.1.1 API Key管理
- ✅ 添加新的API Key（支持手动输入和剪贴板导入）
- ✅ 编辑现有API Key信息
- ✅ 删除API Key（含确认机制）
- ✅ 批量操作支持（导入/导出Excel文件）
- ✅ 分组和标签管理
- ✅ 智能搜索和过滤（支持名称、平台、标签）
- ✅ 使用统计和历史记录
- ✅ 多语言界面支持

#### 3.1.2 快速搜索与调用
- ✅ 全局快捷键唤出搜索界面（默认Ctrl+Shift+K）
- ✅ 实时搜索过滤（带防抖优化）
- ✅ 一键复制到剪贴板（安全剪贴板处理）
- ✅ 浮层工具条界面（可拖动、无全屏遮罩）
- ✅ 径向菜单（RadialMenu）操作
- ✅ 虚拟滚动支持大数据集（VirtualList组件）
- ✅ 独立窗口预览功能

#### 3.1.3 安全存储
- ✅ 可选主密码保护（用户可选择启用/禁用）
- ✅ SQLite数据库加密存储（SQLCipher）
- ✅ 自动锁定机制（闲置超时）
- ✅ 输入验证和危险字符检测（XSS、SQL注入防护）
- ✅ 速率限制保护敏感操作
- ✅ 安全剪贴板处理（自动超时清除）

### 3.2 高级功能（第二阶段）

#### 3.2.1 智能识别
- ✅ 剪贴板监控自动识别API Key格式
- ✅ 智能提示保存新Key
- ✅ 本地LLM分析能力（Ollama集成）
- ✅ 正则表达式备选方案
- ✅ 多语言Excel表头智能匹配

#### 3.2.2 生态集成
- 🔄 VS Code插件开发
- 🔄 主流IDE扩展支持
- 🔄 浏览器扩展（可选）

#### 3.2.3 高级功能
- ✅ 使用统计和分析
- 🔄 自动备份和同步
- 🔄 多设备同步（端到端加密）
- ✅ 自适应主题切换（明暗模式）
- ✅ Toast通知系统
- ✅ 错误边界处理
- ✅ 自适应背景渐变（useBackgroundGradient）
- ✅ 主题切换性能优化（useThemeTransition）
- ✅ 设计系统化（theme.css + tokens.css）
- ✅ 完整的多语言国际化支持（9种语言）
- ✅ 独立窗口多语言支持

## 4. 非功能需求

### 4.1 性能要求
- 启动时间：< 2秒
- 内存占用：< 50MB
- 搜索响应：< 100ms

### 4.2 安全性要求
- ✅ API Key本地加密存储（SQLCipher + AES-256-GCM）
- ✅ 主密码采用强哈希算法（Argon2id）
- ✅ 无网络传输敏感数据
- ✅ 输入验证和危险字符检测
- ✅ 安全剪贴板处理（自动超时清除）
- ✅ 速率限制保护敏感操作
- ✅ 定期安全审计
- ✅ 安全日志服务（secureLogging.ts）
- ✅ 统一错误处理（ServiceResult模式）

### 4.3 兼容性要求
- ✅ Windows 10/11（已测试）
- ✅ macOS 10.15+（已测试）
- ✅ Linux主流发行版（已测试）

## 5. 技术架构

### 5.1 技术选型

#### 后端框架：Tauri
- **选择理由**：轻量、高性能、安全
- **优势**：
  - 利用系统WebView，体积小（<5MB）
  - Rust语言保障内存安全和性能
  - 原生系统集成能力

#### 前端技术栈
- **UI框架**：React 18 + TypeScript
- **样式方案**：Tailwind CSS
- **构建工具**：Vite
- **图标库**：Lucide React
- **UI组件**：shadcn/ui（基于Tailwind）

#### 数据存储
- **数据库**：SQLite + SQLCipher加密
- **加密算法**：AES-256-GCM
- **密钥派生**：Argon2id

### 5.2 系统架构

```
┌─────────────────────────────────────────────┐
│                  前端层                      │
│  React 18 + TypeScript + Tailwind CSS       │
│  • 组件化架构（AddApiKey, RadialMenu等）   │
│  • 状态管理（Hooks + Context）             │
│  • 虚拟滚动和性能优化                       │
│  • 统一错误处理（ServiceResult）           │
└─────────────────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────┐
│                 服务层                      │
│  TypeScript服务模块                         │
│  • API Key服务（CRUD操作）                 │
│  • 安全服务（加密/解密）                   │
│  • 剪贴板服务（安全处理）                   │
│  • 搜索服务（优化算法）                     │
│  • 验证服务（输入清理）                     │
└─────────────────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────┐
│                  Tauri层                    │
│  Rust命令处理                               │
│  • 数据库操作（SQLx + SQLCipher）          │
│  • 系统剪贴板访问                           │
│  • 窗口管理                                │
│  • 全局快捷键注册                          │
└─────────────────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────┐
│                  数据层                     │
│  SQLite + SQLCipher加密数据库               │
│  • API Key表（加密存储）                   │
│  • 分组表                                  │
│  • 使用历史表                              │
│  • 配置表                                  │
└─────────────────────────────────────────────┘
```

## 6. 界面设计原则

### 6.1 设计理念
- **极简主义**：去除不必要的元素，专注核心功能
- **一致性**：统一的视觉语言和交互模式
- **效率优先**：减少操作步骤，提升使用效率

### 6.2 视觉风格
- **色彩方案**：使用Tailwind默认调色板，以蓝灰色系为主
- **字体**：系统默认字体或Inter字体族
- **圆角**：一致的8px圆角设计
- **阴影**：细腻的层次阴影（shadow-sm, shadow-md）

### 6.3 交互设计
- **微交互**：hover效果、过渡动画
- **反馈机制**：操作成功/失败提示
- **快捷键**：全局快捷键+应用内快捷键

### 6.4 界面组件示例

```tsx
// 搜索界面组件示例
const SearchModal: React.FC = () => {
  return (
    <div className="fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center p-4">
      <div className="bg-white rounded-lg shadow-xl w-full max-w-md">
        <div className="p-4 border-b">
          <input
            type="text"
            placeholder="搜索API Key..."
            className="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            autoFocus
          />
        </div>
        <div className="max-h-64 overflow-y-auto">
          {/* 搜索结果列表 */}
        </div>
      </div>
    </div>
  );
};
```

## 7. 开发路线图

### 7.1 第一阶段：MVP（已完成）

#### 第1周：技术验证和基础搭建
- ✅ Tauri项目初始化
- ✅ React + TypeScript + Tailwind配置
- ✅ 基础窗口和界面框架

#### 第2周：核心功能实现
- ✅ API Key的增删改查界面
- ✅ SQLite加密数据库集成（SQLCipher）
- ✅ 主密码设置和验证

#### 第3周：用户体验优化
- ✅ 全局快捷键实现（Ctrl+Shift+K）
- ✅ 搜索和复制功能
- ✅ 基础设置页面

### 7.2 第二阶段：功能完善（已完成）

#### 第4周：高级功能
- ✅ 剪贴板监控和智能识别
- ✅ 分组和标签管理
- ✅ 使用历史记录
- ✅ 智能搜索和过滤
- ✅ 批量导入导出

#### 第5周：界面优化
- ✅ 完整的设置页面
- ✅ 数据导入导出
- ✅ 主题切换支持（明暗模式）
- ✅ 浮层工具条界面
- ✅ 径向菜单设计

#### 第6周：测试和优化
- ✅ 跨平台测试（Windows/macOS/Linux）
- ✅ 性能优化（虚拟滚动、缓存、防抖、主题切换优化）
- ✅ 安全增强（输入验证、速率限制、安全日志服务）
- ✅ 代码质量提升（类型安全、统一错误处理、ServiceResult模式）
- ✅ 多语言支持实现（独立窗口、Excel表头、界面文本）

### 7.3 第三阶段：生态扩展（后续）
- [ ] VS Code插件开发
- [ ] 浏览器扩展
- [ ] 移动端应用

## 8. 风险评估与应对

### 8.1 技术风险
- **Rust学习曲线**：安排学习时间，参考官方文档
- **跨平台兼容性**：早期进行多平台测试
- **加密安全性**：使用成熟加密库，避免自研算法

### 8.2 产品风险
- **用户接受度**：通过MVP快速验证核心价值
- **竞争压力**：专注个人使用场景，差异化设计
- **功能蔓延**：严格遵循MVP原则，优先核心功能

## 9. 成功标准

### 9.1 技术成功标准
- ✅ 应用体积 < 10MB
- ✅ 内存占用 < 50MB
- ✅ 启动时间 < 2秒
- ✅ 无安全漏洞

### 9.2 产品成功标准
- ✅ 每日活跃用户 > 10
- ✅ 用户满意度 > 4.5/5
- ✅ 平均使用时长 > 5分钟/天
- ✅ 推荐意愿 > 80%

## 10. 附录

### 10.1 参考资料
- Tauri官方文档：https://tauri.app/
- Tailwind CSS文档：https://tailwindcss.com/
- SQLCipher文档：https://www.zetetic.net/sqlcipher/

### 10.2 相关工具
- 设计工具：Figma
- 版本控制：Git
- 项目管理：GitHub Projects
- 持续集成：GitHub Actions

---

**文档版本**：v1.1
**最后更新**：2025年9月22日
**负责人**：产品经理团队

### 10.3 多语言支持详情

#### 支持语言列表
- **zh-CN**: 简体中文
- **en-US**: 英语
- **zh-TW**: 繁体中文
- **pt-BR**: 葡萄牙语
- **es-ES**: 西班牙语
- **fr-FR**: 法语
- **it-IT**: 意大利语
- **ja-JP**: 日语
- **ru-RU**: 俄语

#### 多语言实现特性
- ✅ 完整的界面翻译覆盖
- ✅ 独立窗口多语言支持
- ✅ Excel模板多语言生成
- ✅ 智能表头匹配（支持多语言Excel文件）
- ✅ 动态语言切换
- ✅ 统一的翻译管理系统